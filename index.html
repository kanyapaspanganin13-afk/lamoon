<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="apple-touch-icon" href="https://i.ibb.co/kVrdspsT/Barber-note-pro.jpg">
    <title>Barber Note Pro v.12.13</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
        :root {
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --primary-blue: #4338ca;
            --cash-green: #10b981;
            --trans-purple: #6366f1;
            --tip-mint: #ccfbf1;
            --text-main: #1e293b;
        }

        body { 
            background-color: var(--bg-color); 
            font-family: 'Kanit', sans-serif; 
            margin: 0; 
            padding-bottom: 120px; /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ Nav ‡∏•‡πà‡∏≤‡∏á */
            overflow-x: hidden;
        }

        /* --- CSS ‡∏ó‡∏µ‡πà‡πÄ‡∏ñ‡πâ‡∏≤‡πÅ‡∏Å‡πà‡∏™‡πà‡∏á‡∏°‡∏≤ (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏¥‡∏ö) --- */
        .container { padding: 15px; max-width: 500px; margin: auto; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 15px; }
        
        .icon-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 15px 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            border: none;
            cursor: pointer;
            transition: 0.2s;
        }
        .icon-card:active { transform: scale(0.95); }
        .icon-card i { font-size: 20px; margin-bottom: 8px; }
        .icon-card span { font-size: 11px; font-weight: 700; color: #64748b; }

        .input-group {
            background: var(--card-bg);
            border-radius: 20px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 15px rgba(0,0,0,0.03);
            position: relative;
            overflow: hidden;
        }
        .input-group input, .input-group select {
            width: 100%; border: none; background: transparent;
            text-align: center; font-size: 16px; font-weight: 700;
            color: var(--text-main); outline: none; padding: 0 10px;
        }

        .price-box {
            background: var(--card-bg);
            border-radius: 25px;
            height: 85px;
            display: flex;
            align-items: center;
            padding: 0 25px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            margin-bottom: 15px;
        }
        .price-box span { font-size: 28px; font-weight: 900; color: var(--trans-purple); margin-right: 12px; }
        .price-box input {
            font-size: 42px; font-weight: 900; width: 100%;
            border: none; outline: none; color: var(--text-main);
        }

        .btn-save-final {
            width: 100%; height: 85px; border-radius: 28px;
            background: linear-gradient(135deg, #4338ca, #1e1b4b);
            color: white; font-size: 28px; font-weight: 900;
            border: none; margin-top: 20px;
            display: flex; align-items: center; justify-content: center;
            gap: 15px; box-shadow: 0 15px 35px rgba(55, 48, 163, 0.3);
            cursor: pointer;
        }

        /* Nav Bar ‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏ñ‡πâ‡∏≤‡πÅ‡∏Å‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: #1e1b4b; height: 85px;
            display: grid; grid-template-columns: 1fr 1fr 1fr;
            align-items: center; z-index: 1000;
            border-radius: 25px 25px 0 0;
        }
        .nav-btn {
            color: #94a3b8; text-align: center;
            text-decoration: none; font-size: 12px; font-weight: 700;
            display: flex; flex-direction: column; align-items: center;
        }
        .nav-btn.active { color: white; }
        .nav-btn i { font-size: 24px; margin-bottom: 5px; }

        /* Animation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Modal */
        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body id="mainBody">
    <div class="container" style="max-width: 480px; margin: 0 auto; padding-bottom: 100px;">
        
        <header style="display: flex; justify-content: space-between; align-items: center; padding: 20px 15px; background: transparent;">
            <div style="width:40px"></div>
            <h1 id="shopNameDisp" style="margin:0; font-size:22px; font-weight:900; color:#1e293b; letter-spacing:1px; text-transform:uppercase;">BARBER SHOP</h1>
            <div onclick="openSettings()" style="width:40px; height:40px; background:#fff; border-radius:12px; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 10px rgba(0,0,0,0.05); cursor:pointer;">
                <i class="fas fa-cog" style="color:#64748b;"></i>
            </div>
        </header>

        <div id="p1" class="page active" style="padding: 0 15px;">
            <div class="grid-3" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px;">
                <div class="icon-card" onclick="handleInsurance()" style="background:#fff; border-radius:20px; height:90px; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow:0 8px 15px rgba(0,0,0,0.05);">
                    <div style="background:linear-gradient(135deg, #fbbf24, #f59e0b); width:38px; height:38px; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-bottom:8px; color:#fff;"><i class="fas fa-shield-alt"></i></div>
                    <span style="font-size:11px; font-weight:800; color:#1e293b;">‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</span>
                </div>
                <div class="icon-card" onclick="handleHoliday()" style="background:#fff; border-radius:20px; height:90px; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow:0 8px 15px rgba(0,0,0,0.05);">
                    <div style="background:linear-gradient(135deg, #f87171, #ef4444); width:38px; height:38px; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-bottom:8px; color:#fff;"><i class="fas fa-umbrella-beach"></i></div>
                    <span style="font-size:11px; font-weight:800; color:#1e293b;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î</span>
                </div>
                <div class="icon-card" onclick="openSettings()" style="background:#fff; border-radius:20px; height:90px; display:flex; flex-direction:column; align-items:center; justify-content:center; box-shadow:0 8px 15px rgba(0,0,0,0.05);">
                    <div style="background:linear-gradient(135deg, #94a3b8, #475569); width:38px; height:38px; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-bottom:8px; color:#fff;"><i class="fas fa-tools"></i></div>
                    <span style="font-size:11px; font-weight:800; color:#1e293b;">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</span>
                </div>
            </div>

            <div class="grid-3" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
                <div style="background:#fff; border-radius:18px; height:60px; position:relative; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 10px rgba(0,0,0,0.03);">
                    <span style="font-weight:700; color:#475569; font-size:14px;">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span>
                    <input type="date" id="dateInp" style="position:absolute; opacity:0; width:100%; height:100%; cursor:pointer;">
                </div>
                <input type="tel" id="tStart" placeholder="‡πÄ‡∏£‡∏¥‡πà‡∏°" class="time-input" maxlength="4" style="height:60px; border-radius:18px; border:none; text-align:center; font-weight:700; background:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.03);">
                <input type="tel" id="tEnd" placeholder="‡πÄ‡∏™‡∏£‡πá‡∏à" class="time-input" maxlength="4" style="height:60px; border-radius:18px; border:none; text-align:center; font-weight:700; background:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.03);">
            </div>

          <div style="display: grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 8px; margin-bottom: 15px;">
    <select id="hairStyle" style="height: 70px; border-radius:18px; border:none; font-weight:800; padding:0 10px; background:#fff; color:#1e293b; box-shadow: 0 4px 10px rgba(0,0,0,0.03); outline:none;">
        <option value="">‚úÇÔ∏è ‡∏ó‡∏£‡∏á‡∏ú‡∏°</option>
        <option value="‡πÄ‡∏î‡πá‡∏Å">‡∏ï‡∏±‡∏î‡∏ú‡∏°‡πÄ‡∏î‡πá‡∏Å</option>
        <option>‡∏£‡∏≠‡∏á‡∏ó‡∏£‡∏á</option><option>‡πÅ‡∏ü‡∏ä‡∏±‡πà‡∏ô</option><option>‡∏™‡∏Å‡∏¥‡∏ô‡πÄ‡∏ü‡∏î</option><option>‡πÄ‡∏õ‡∏¥‡∏î‡∏Ç‡πâ‡∏≤‡∏á</option><option>‡∏ï‡∏≥‡∏£‡∏ß‡∏à/‡∏ó‡∏´‡∏≤‡∏£</option><option>‡∏ó‡∏£‡∏á‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
        <option>‡πÅ‡∏Å‡πâ‡∏ú‡∏°</option><option>‡πÇ‡∏Å‡∏ô‡∏ú‡∏°</option>
    </select>
    
    <select id="extra1" style="height: 70px; border-radius:14px; border:none; font-weight:700; background:#fff; color:#64748b; box-shadow: 0 4px 10px rgba(0,0,0,0.03); outline:none;">
        <option value="">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£1</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option>
    </select>
    
    <select id="extra2" style="height: 70px; border-radius:14px; border:none; font-weight:700; background:#fff; color:#64748b; box-shadow: 0 4px 10px rgba(0,0,0,0.03); outline:none;">
        <option value="">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£2</option><option>‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î</option><option>‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤</option><option>‡∏™‡∏£‡∏∞‡∏ú‡∏°</option><option>‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°</option>
    </select>
</div>

<div style="display: grid; grid-template-columns: 1.4fr 1fr; gap: 8px; margin: 10px 0;">
    <div style="position: relative; background: #ffffff; border-radius: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.05);">
        <span style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 24px; color: #6366f1; font-weight: 900;">‡∏ø</span>
        <input type="number" id="priceInp" placeholder="0" inputmode="numeric" 
            style="width: 100%; height: 85px; background: transparent; font-size: 45px; font-weight: 900; color: #1e293b; text-align: right; padding-right: 20px; border: none; outline: none; box-sizing: border-box;">
    </div>

    <input type="number" id="tipInp" placeholder="‡∏ó‡∏¥‡∏õ" inputmode="numeric" 
        style="width: 100%; height: 85px; background: #ccfbf1; border-radius: 20px; font-size: 32px; font-weight: 900; color: #0f766e; text-align: center; border: none; outline: none;">
</div>

<div class="grid-2" style="display: grid; grid-template-columns: 1fr 1fr; gap:12px; margin-bottom:20px;">
    <button id="btnCash" onclick="selectPay('Cash')" style="height:75px; border-radius:22px; border:none; background:linear-gradient(135deg, #10b981, #059669); color:#fff; font-weight:900; font-size:22px; box-shadow:0 8px 20px rgba(16,185,129,0.3); cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px;">
        <i class="fas fa-money-bill-wave"></i> ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î
    </button>
    <button id="btnTrans" onclick="selectPay('Trans')" style="height:75px; border-radius:22px; border:none; background:linear-gradient(135deg, #6366f1, #4338ca); color:#fff; font-weight:900; font-size:22px; box-shadow:0 8px 20px rgba(99,102,241,0.3); cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px;">
        <i class="fas fa-qrcode"></i> ‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢
    </button>
</div>

<button class="btn-main" onclick="handleSave(event)" style="width:100%; height:90px; border-radius:28px; background:linear-gradient(135deg, #4338ca, #3730a3); color:#fff; border:none; cursor:pointer; box-shadow:0 15px 35px rgba(67,56,202,0.4); display:flex; align-items:center; justify-content:center; gap:15px;">
    <i class="fas fa-save" style="font-size: 38px;"></i>
    <span style="font-size: 32px; font-weight: 900; letter-spacing:1px;">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
</button>

<div id="p2" class="page" style="max-width:480px; margin:0 auto; padding: 15px; padding-bottom: 100px;">
    <div style="background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); padding:25px 20px; border-radius:28px; color:white; box-shadow:0 15px 30px rgba(30,58,138,0.25); margin-bottom: 20px; position:relative; overflow:hidden;">
        <div style="position:absolute; right:-20px; top:-20px; width:100px; height:100px; background:rgba(255,255,255,0.1); border-radius:50%;"></div>
        
        <small style="font-weight:600; opacity:0.8; text-transform: uppercase; letter-spacing:1px;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</small>
        <div style="display:flex; align-items:baseline; gap:5px; margin: 8px 0;">
            <span style="font-size:24px; font-weight:700;">‡∏ø</span>
            <div id="dTotal" style="font-size:45px; font-weight:900; line-height:1;">0</div>
        </div>
        <div id="dCounts" style="font-size:14px; font-weight:600; background:rgba(255,255,255,0.2); display:inline-block; padding:4px 15px; border-radius:12px; backdrop-filter:blur(5px);">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ 0 ‡∏Ñ‡∏ô</div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
        <div style="background:white; padding:15px; border-radius:22px; box-shadow:0 8px 20px rgba(0,0,0,0.04); border: 1px solid #f1f5f9;">
            <div style="display:flex; justify-content:space-between; margin-bottom:8px; font-size:13px; font-weight:700; color:#64748b;"><span>üì± ‡πÇ‡∏≠‡∏ô</span><b id="dTrans" style="color:#6366f1;">0</b></div>
            <div style="display:flex; justify-content:space-between; font-size:13px; font-weight:700; color:#64748b;"><span>üíµ ‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</span><b id="dCash" style="color:#10b981;">0</b></div>
        </div>
        <div style="background:white; padding:15px; border-radius:22px; box-shadow:0 8px 20px rgba(0,0,0,0.04); border: 1px solid #f1f5f9;">
            <div style="display:flex; justify-content:space-between; margin-bottom:8px; font-size:13px; font-weight:700; color:#64748b;"><span>ü§µ ‡∏ä‡πà‡∏≤‡∏á</span><b id="dBarber" style="color:#f59e0b;">0</b></div>
            <div style="display:flex; justify-content:space-between; font-size:13px; font-weight:800; color:#64748b;"><span>üè† ‡∏£‡πâ‡∏≤‡∏ô</span><b id="dShop" style="color:#1e293b;">0</b></div>
        </div>
    </div>

    <div id="settleBarContainer" style="margin-bottom:18px;"><div id="settleBar"></div> </div>
    
   <div style="background:white; border-radius:25px; padding:20px; box-shadow:0 10px 20px rgba(0,0,0,0.03);">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
        <b style="font-size:16px; color:#1e293b;">üìå ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</b>
        <div onclick="shareLine()" style="background:#f0fdf4; color:#16a34a; padding:6px 12px; border-radius:10px; font-size:13px; font-weight:800; cursor:pointer;">
            <i class="fab fa-line"></i> ‡∏™‡πà‡∏á‡πÑ‡∏•‡∏ô‡πå
        </div>
    </div>
    
    <div id="dServiceStats"></div>
    <div id="dailyList"></div>

    <button onclick="confirmCloseDay()" style="width:100%; height:60px; margin-top:15px; border-radius:15px; border:none; background:linear-gradient(135deg, #f59e0b, #d97706); color:white; font-size:18px; font-weight:900; display:flex; align-items:center; justify-content:center; gap:10px; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2); cursor:pointer;">
        <i class="fas fa-calendar-check"></i> ‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤ 3
    </button>
</div>

<div id="p3" class="page" style="max-width:480px; margin:0 auto; padding: 15px; padding-bottom: 100px;">
    <div style="background:#ffffff; border-radius:30px; padding:25px; box-shadow: 0 20px 40px rgba(0,0,0,0.06); margin-bottom: 20px; border:1px solid #f1f5f9;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
            <div style="display:flex; align-items:center; gap:8px;">
                <div style="background:#fff7ed; color:#c2410c; width:35px; height:35px; border-radius:10px; display:flex; align-items:center; justify-content:center;">
                    <i class="fas fa-wallet"></i>
                </div>
                <b style="font-size:18px; color:#1e293b;">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</b>
            </div>
            <div id="accLight" style="background:#22c55e; width:12px; height:12px; border-radius:50%; box-shadow:0 0 10px rgba(34,197,94,0.5);"></div>
        </div>

        <div style="text-align:center; margin-bottom:25px; padding:20px; background:#f8fafc; border-radius:25px;">
            <small style="color:#64748b; font-weight:700; text-transform:uppercase; letter-spacing:1px;">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏™‡∏∞‡∏™‡∏°</small>
            <div style="font-size:52px; font-weight:900; color:#1e1b4b; margin-top:5px;">‡∏ø<span id="accNet">0</span></div>
        </div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:25px;">
            <div style="background:#fff; border-radius:20px; padding:15px; text-align:center; border:1.5px solid #f1f5f9;">
                <small style="font-size:11px; color:#94a3b8; font-weight:700;">‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏°</small>
                <b style="font-size:20px; color:#ef4444; font-weight:800; display:block;" id="accOldVal">‡∏ø0</b>
            </div>
            <div style="background:#fff; border-radius:20px; padding:15px; text-align:center; border:1.5px solid #f1f5f9;">
                <small style="font-size:11px; color:#94a3b8; font-weight:700;">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</small>
                <b style="font-size:20px; color:#10b981; font-weight:800; display:block;" id="accTodayVal">‡∏ø0</b>
            </div>
        </div>

        <div style="background:#f1f5f9; border-radius:20px; padding:15px; margin-bottom:20px;">
            <div style="display:flex; align-items:center; border-bottom:1px solid #e2e8f0; padding-bottom:10px; margin-bottom:10px;">
                <i class="fas fa-calendar-alt" style="color:#6366f1; width:25px;"></i>
                <input type="date" id="accDate" style="flex:1; border:none; background:none; font-size:16px; font-weight:700; outline:none; color:#1e293b;">
            </div>
            <div style="display:flex; align-items:center;">
                <i class="fas fa-pen-nib" style="color:#94a3b8; width:25px;"></i>
                <input type="text" id="accNote" placeholder="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏≥..." style="flex:1; border:none; background:none; font-size:15px; font-weight:500; outline:none; color:#1e293b;">
            </div>
        </div>

        <div style="display:grid; grid-template-columns: 1.2fr 1fr; gap:12px;">
            <button onclick="clearAccount()" style="background:linear-gradient(135deg, #10b981, #059669); color:#fff; border:none; border-radius:20px; padding:18px 5px; font-size:15px; font-weight:800; box-shadow:0 8px 20px rgba(16,185,129,0.25);">
                <i class="fas fa-check-double"></i> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏á‡∏¥‡∏ô
            </button>
            <button onclick="openHistoryModal()" style="background:#fff; color:#6366f1; border:2px solid #e0e7ff; border-radius:20px; padding:18px 5px; font-size:14px; font-weight:800;">
                <i class="fas fa-history"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            </button>
        </div>
    </div>

    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
        <div onclick="$('histDate').showPicker()" style="background:#ffffff; border-radius:25px; padding:22px 15px; text-align:center; position:relative; box-shadow:0 8px 20px rgba(0,0,0,0.03); border:1.5px solid #f1f5f9;">
            <div style="background:#fff7ed; width:45px; height:45px; border-radius:15px; display:flex; align-items:center; justify-content:center; margin:0 auto 10px; color:#f59e0b;">
                <i class="fas fa-search-dollar" style="font-size:22px;"></i>
            </div>
            <b style="font-size:14px; color:#1e293b;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</b>
            <input type="date" id="histDate" onchange="loadHistDaily()" style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </div>
        <div onclick="$('histMonth').showPicker()" style="background:#ffffff; border-radius:25px; padding:22px 15px; text-align:center; position:relative; box-shadow:0 8px 20px rgba(0,0,0,0.03); border:1.5px solid #f1f5f9;">
            <div style="background:#eef2ff; width:45px; height:45px; border-radius:15px; display:flex; align-items:center; justify-content:center; margin:0 auto 10px; color:#6366f1;">
                <i class="fas fa-chart-pie" style="font-size:22px;"></i>
            </div>
            <b style="font-size:14px; color:#1e293b;">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</b>
            <input type="month" id="histMonth" onchange="loadHistMonth()" style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </div>
    </div>
</div>
<div id="modalSet" style="display:none; position:fixed; inset:0; background:rgba(15, 23, 42, 0.7); backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px); z-index:99999; align-items:flex-end; justify-content:center;">
    
    <div style="background:#ffffff; width:100%; max-width:500px; border-radius:35px 35px 0 0; box-shadow:0 -10px 40px rgba(0,0,0,0.2); animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1); display:flex; flex-direction:column; overflow:hidden;">
        
        <div style="padding:15px 0 5px; text-align:center; cursor:pointer;" onclick="document.getElementById('modalSet').style.display='none'">
            <div style="width:50px; height:6px; background:#e2e8f0; border-radius:10px; margin:0 auto;"></div>
        </div>

        <div style="padding:15px 25px 40px;">
            <h3 style="margin:0 0 25px; font-size:22px; color:#1e1b4b; font-weight:900; text-align:center;">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>

            <div style="margin-bottom:20px;">
                <label style="display:flex; align-items:center; gap:6px; font-size:12px; font-weight:800; color:#64748b; margin-bottom:10px; text-transform:uppercase; letter-spacing:0.5px;">
                    <i class="fas fa-store"></i> ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                </label>
                <input type="text" id="setShop" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; text-align:center; font-size:18px; font-weight:700; color:#1e293b; outline:none; transition:0.2s;">
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:20px;">
                <div>
                    <label style="display:block; font-size:11px; font-weight:800; color:#64748b; margin-bottom:8px;">% ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ä‡πà‡∏≤‡∏á</label>
                    <input type="number" id="setPerc" placeholder="‡πÄ‡∏ä‡πà‡∏ô 50" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; text-align:center; font-size:18px; font-weight:700; outline:none;">
                </div>
                <div>
                    <label style="display:block; font-size:11px; font-weight:800; color:#64748b; margin-bottom:8px;">‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</label>
                    <input type="number" id="setGuar" placeholder="0.00" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; text-align:center; font-size:18px; font-weight:700; outline:none;">
                </div>
            </div>

            <div style="margin-bottom:20px;">
                <label style="display:block; font-size:11px; font-weight:800; color:#64748b; margin-bottom:8px;">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏µ‡πÅ‡∏≠‡∏õ (Theme)</label>
                <select id="setTheme" onchange="changeTheme(this.value)" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; padding:0 20px; font-size:16px; font-weight:700; outline:none; appearance:none;">
                    <option value="light">üå§ Light Mode (‡∏™‡∏ß‡πà‡∏≤‡∏á)</option>
                    <option value="navy">üåå Navy Premium (‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°)</option>
                    <option value="dark">üåë Midnight Gold (‡∏î‡∏≥-‡∏ó‡∏≠‡∏á)</option>
                </select>
            </div>

            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom:30px;">
                <select id="setSound" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; padding:0 15px; font-weight:700; outline:none;">
                    <option value="on">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á</option>
                    <option value="off">üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á</option>
                </select>
                <select id="setVoice" style="width:100%; height:60px; border-radius:20px; border:2px solid #f1f5f9; background:#f8fafc; padding:0 15px; font-weight:700; outline:none;">
                    <option value="female">üëß ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á </option>
                    <option value="male">üë® ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢ </option>
                </select>
            </div>

            <div style="display:grid; grid-template-columns: 2.5fr 1fr; gap:15px;">
                <button onclick="saveSettings()" style="background:linear-gradient(135deg, #4338ca, #1e1b4b); color:#fff; height:75px; border-radius:25px; border:none; font-weight:900; font-size:20px; box-shadow:0 10px 25px rgba(67,56,202,0.3); cursor:pointer;">
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                </button>
                <button onclick="document.getElementById('modalSet').style.display='none'" style="background:#fff1f2; color:#e11d48; height:75px; border-radius:25px; border:none; font-size:35px; display:flex; align-items:center; justify-content:center; cursor:pointer;">
                    <i class="fas fa-power-off"></i>
                </button>
            </div>

            <button id="dangerZone" onclick="clearAllData()" style="width:100%; margin-top:30px; background:none; border:none; color:#fca5a5; font-size:14px; font-weight:700; text-decoration:underline; cursor:pointer; opacity:0.6;">
                ‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            </button>
        </div>
    </div>
</div>
<nav class="bottom-nav">
    <a href="javascript:go(1)" class="nav-btn active"><i class="fas fa-edit"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</a>
    <a href="javascript:go(2)" class="nav-btn"><i class="fas fa-history"></i>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</a>
    <a href="javascript:go(3)" class="nav-btn"><i class="fas fa-wallet"></i>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</a>
</nav>
<style>
@keyframes slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}
#modalSet input:focus, #modalSet select:focus {
    border-color: #6366f1 !important;
    background: #ffffff !important;
}
</style>
</body>
    <script>
    let payMethod="", conf=JSON.parse(localStorage.getItem("barber_conf"))||{shop:"Barber Shop",perc:50,guar:0,theme:"light",bg:"#f1f5f9",sound:"on",voice:"female"}, db=JSON.parse(localStorage.getItem("barber_db"))||[], archives=JSON.parse(localStorage.getItem("barber_arc"))||[];
    const $=(id)=>document.getElementById(id);
    window.onload=()=>{ $("dateInp").valueAsDate=new Date(); applySettings(); };
    function speak(t){ if(conf.sound==="off")return; window.speechSynthesis.cancel(); const m=new SpeechSynthesisUtterance(t); m.lang='th-TH'; m.pitch=conf.voice==="male"?0.6:1.1; window.speechSynthesis.speak(m); }
    document.querySelectorAll('.time-input').forEach(i=>i.addEventListener('input',e=>{ let v=e.target.value.replace(/\D/g,''); if(v.length>=4) e.target.value=v.substring(0,2)+":"+v.substring(2,4); }));
    function go(n){ document.querySelectorAll('.page, .nav-item').forEach(el=>el.classList.remove('active')); $("p"+n).classList.add('active'); $("n"+n).classList.add('active'); if(n===2) renderDay(); }
    function selectPay(m){ payMethod=m; $("btnCash").className=m==='Cash'?'btn-pay active-cash':'btn-pay'; $("btnTrans").className=m==='Trans'?'btn-pay active-transfer':'btn-pay'; }
    function handleSave(){const p=$("priceInp").value; if(!p||!payMethod){ speak("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"); return; }let svcs=[($("mainSvc").value||"‡∏ï‡∏±‡∏î‡∏ú‡∏°"),$("extra1").value,$("extra2").value].filter(s=>s);db.push({id:Date.now(),date:$("dateInp").value,time:`${$("tStart").value}-${$("tEnd").value}`,mainSvc:$("mainSvc").value||"‡∏ï‡∏±‡∏î‡∏ú‡∏°",svcs,hair:$("hairStyle").value,price:Number(p),pay:payMethod});
    localStorage.setItem("barber_db",JSON.stringify(db)); speak("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å "+p+" ‡∏ö‡∏≤‡∏ó ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");$("mainSaveBtn").innerText="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚úì"; $("mainSaveBtn").style.background="var(--accent)";setTimeout(()=>{ $("mainSaveBtn").innerText="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"; $("mainSaveBtn").style.background="var(--primary)"; $("priceInp").value=""; if($("tEnd").value){ $("tStart").value=$("tEnd").value; $("tEnd").value=""; } $("extra1").value=$("extra2").value=""; selectPay(""); },600);
    }
    function renderDay(){
    const d=$("dateInp").value, today=db.filter(r=>r.date===d); let tot=0,trans=0,cash=0,stats={},listHtml="";today.sort((a,b)=>a.time.localeCompare(b.time)).forEach(r=>{tot+=r.price; r.pay==='Trans'?trans+=r.price:cash+=r.price; r.svcs.forEach(s=>stats[s]=(stats[s]||0)+1);listHtml+=`<div class="history-row"><div style="display:flex; justify-content:space-between"><span>${r.time} | ${r.svcs.join('+')}</span><b>‡∏ø${r.price}</b></div><div style="display:flex; justify-content:space-between; opacity:0.7"><span>${r.hair||''}</span><span>${r.pay==='Cash'?'üíµ ‡∏™‡∏î':'üì± ‡πÇ‡∏≠‡∏ô'} <i class="fas fa-trash" style="margin-left:10px; color:var(--danger)" onclick="delRec(${r.id})"></i></span></div></div>`;
        });
        const bEarn=Math.max(tot*(conf.perc/100),conf.guar), sEarn=tot-bEarn, settle=cash-bEarn;
        $("dTotal").innerText=tot.toLocaleString(); $("dTrans").innerText=trans.toLocaleString(); $("dBarber").innerHTML=`${Math.floor(bEarn).toLocaleString()} <small>(‡∏™‡∏î: ${cash})</small>`; $("dShop").innerText=Math.floor(sEarn).toLocaleString(); $("dCounts").innerText=`‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${today.length} ‡∏Ñ‡∏ô`; $("dailyList").innerHTML=listHtml||"<center style='opacity:0.3; padding:20px'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</center>";
        let sH=""; for(let s in stats) sH+=`<span class="badge">${s}: ${stats[s]}</span>`; $("dServiceStats").innerHTML=sH;
        const b=$("settleBar"); if(tot===0){ b.innerText="üü¶ ‡∏£‡πâ‡∏≤‡∏ô‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô"; b.className="status-bar status-blue"; } else if(settle>0){ b.innerText=`üü• ‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô ‡∏ø${Math.floor(settle).toLocaleString()}`; b.className="status-bar status-red"; } else if(settle<0){ b.innerText=`üü¶ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á ‡∏ø${Math.floor(Math.abs(settle)).toLocaleString()}`; b.className="status-bar status-indigo"; } else { b.innerText="‚úÖ ‡∏¢‡∏≠‡∏î‡∏û‡∏≠‡∏î‡∏µ"; b.className="status-bar status-green"; }
    }
    function delRec(id) {
        if(confirm("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?")) {db = db.filter(r => r.id !== id);localStorage.setItem("barber_db", JSON.stringify(db)); speak("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");renderDay(); }
    }
    function closeDay() {const d = document.getElementById("dateInp").value;const today = db.filter(r => r.date === d);if(!today.length) return alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•");if(confirm("‡∏õ‡∏¥‡∏î‡∏¢‡∏≠‡∏î‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥?")) {
    const tot = today.reduce((a,b) => a+b.price, 0);const cash = today.filter(r=>r.pay==='Cash').reduce((a,b)=>a+b.price, 0);const bEarn = Math.max(tot * (conf.perc/100), conf.guar);
    let dailyStats = {};today.forEach(r => {r.svcs.forEach(s => { dailyStats[s] = (dailyStats[s] || 0) + 1;});});
    const arc = {date: d, total: tot, cash: cash, barber: bEarn, shop: tot - bEarn, settle: cash - bEarn, count: today.length, details: today, stats: dailyStats }; archives = archives.filter(a => a.date !== d);archives.push(arc);localStorage.setItem("barber_arc", JSON.stringify(archives));db = db.filter(r => r.date !== d);localStorage.setItem("barber_db", JSON.stringify(db));
    speak("‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");alert("‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");go(3);}
    }
    function loadHistDaily() {
        const d = document.getElementById("histDate").value;const found = archives.find(a => a.date === d); area = document.getElementById("histDailyArea"); if(!found) { area.innerHTML = "<center style='color:#ccc; padding:20px;'>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</center>"; return; }
         let rows = found.details.map(r => `<div class="history-row" style="font-size:13px;"><div style="display:flex; justify-content:space-between"><b>${r.time} | ${r.svcs.join('+')}</b> <b>‡∏ø${r.price}</b></div><div style="font-size:13px; font-weight:600; color:var(--text);">${r.hair || ''} <span style="font-weight:300; opacity:0.6">(${r.pay==='Cash'?'‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î':'‡πÇ‡∏≠‡∏ô'})</span></div>
        </div>`).join('');let statBadges = "";if (found.stats) {for(let s in found.stats) { statBadges += `<span class="badge" style="background:#eee; color:#333; margin-right:4px;">${s}: ${found.stats[s]}</span>`; }
        }
        const settle = found.settle || 0;const cash = found.cash || 0;const settleText = settle > 0 ? `‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô: ‡∏ø${Math.floor(settle).toLocaleString()}` : settle < 0 ? `‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á: ‡∏ø${Math.floor(Math.abs(settle)).toLocaleString()}` : "‡∏¢‡∏≠‡∏î‡∏û‡∏≠‡∏î‡∏µ";
        const settleClass = settle > 0 ? "status-red" : settle < 0 ? "status-indigo" : "status-green";area.innerHTML = `<div style="background:var(--input-bg); padding:15px; border-radius:15px;"><div class="status-bar ${settleClass}" style="padding:8px; font-size:13px; margin-bottom:10px;">${settleText}</div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:15px; font-size:13px;"><div>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <b>${found.total.toLocaleString()}</b></div><div>‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î: <b>${cash.toLocaleString()}</b></div><div>‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ: <b>${Math.floor(found.barber).toLocaleString()}</b></div><div>‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏î‡πâ: <b>${Math.floor(found.shop).toLocaleString()}</b></div>
        </div>
        <div style="margin-bottom:15px; display:flex; flex-wrap:wrap; gap:4px;">${statBadges}</div><div style="border-top:1px dashed #ccc; padding-top:10px;">${rows}</div></div>`;
    }
    function loadHistMonth() {
        const m = document.getElementById("histMonth").value;
        const area = document.getElementById("histMonthArea");
        if(!m) return;
        const filtered = archives.filter(a => a.date.startsWith(m));
        if(!filtered.length) { area.innerHTML = "<center style='color:#ccc; padding:20px;'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</center>"; return; }
        let tot = 0, bTot = 0, cTot = 0, monthStats = {};filtered.forEach(a => { tot += a.total; bTot += a.barber; cTot += a.count;if(a.stats) { for(let s in a.stats) { monthStats[s] = (monthStats[s] || 0) + a.stats[s]; } }});
        let monthStatBadges = "";for(let s in monthStats) { monthStatBadges += `<span class="badge" style="background:var(--indigo); color:white; font-weight:300;">${s}: ${monthStats[s]}</span>`; }
        area.innerHTML = `<div style="padding:15px; background:var(--input-bg); border-radius:15px;"><div style="font-size:20px; margin-bottom:10px;">‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°: <b style="color:var(--primary)">‡∏ø${tot.toLocaleString()}</b></div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; font-size:13px; opacity:0.8;"><div>‡∏ä‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏°: <b>‡∏ø${Math.floor(bTot).toLocaleString()}</b></div><div>‡∏£‡πâ‡∏≤‡∏ô‡∏£‡∏ß‡∏°: <b>‡∏ø${Math.floor(tot-bTot).toLocaleString()}</b></div><div>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏∞‡∏™‡∏°: <b>${cTot} ‡∏Ñ‡∏ô</b></div>
        <div>‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô: <b>${filtered.length} ‡∏ß‡∏±‡∏ô</b></div> </div>
        <div style="margin-top:15px; border-top:1px dashed #ccc; padding-top:10px;"><label style="font-size:11px; opacity:0.6;">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label><div style="margin-top:5px;">${monthStatBadges || '<span style="opacity:0.4">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</span>'}</div></div></div>`;
    }

    function shareLine() {
    const d = $("dateInp").value, today = db.filter(r => r.date === d);if (!today.length) return;
    let tot = 0, trans = 0, cash = 0, counts = {"‡πÄ‡∏î‡πá‡∏Å":0, "‡∏™‡∏£‡∏∞‡∏ú‡∏°":0, "‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î":0, "‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°":0};
    let msg = `üíà ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡πâ‡∏≤‡∏ô: ${conf.shop}\nüìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${d}\n-------------------------\nüìù ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏ß‡∏° ${today.length} ):\n`;today.forEach((r, i) => {tot += r.price;r.pay === 'Trans' ? trans += r.price : cash += r.price;
    let name = r.hair || r.svcs[0];if (r.mainSvc === "‡πÄ‡∏î‡πá‡∏Å") name += "(‡πÄ‡∏î‡πá‡∏Å)";msg += `${i + 1}. [${r.time}] ${name} = ${r.price} ${r.pay === 'Cash' ? 'üíµ' : 'üì±'}\n`; r.svcs.forEach(s => {
    if (s.includes("‡πÄ‡∏î‡πá‡∏Å")) counts["‡πÄ‡∏î‡πá‡∏Å"]++;else if (s.includes("‡∏™‡∏£‡∏∞")) counts["‡∏™‡∏£‡∏∞‡∏ú‡∏°"]++;else if (s.includes("‡πÇ‡∏Å‡∏ô") || s.includes("‡∏Å‡∏±‡∏ô‡∏´‡∏ô‡πâ‡∏≤")) counts["‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î"]++;else if (s.includes("‡∏¢‡πâ‡∏≠‡∏°") || s.includes("‡∏î‡∏±‡∏î")) counts["‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°"]++;
        });
    });
    const bE = Math.max(tot * (conf.perc / 100), conf.guar), settle = Math.floor(cash - bE);
    msg += `-------------------------\nüìä ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô:\n`;
    const icons = {"‡πÄ‡∏î‡πá‡∏Å":"üßí", "‡∏™‡∏£‡∏∞‡∏ú‡∏°":"üßº", "‡πÇ‡∏Å‡∏ô‡∏´‡∏ô‡∏ß‡∏î":"ü™í", "‡∏¢‡πâ‡∏≠‡∏°‡∏ú‡∏°":"üé®"};for (let k in counts) { if(counts[k] > 0) msg += `${icons[k]} ${k}: ${counts[k]} \n`; }
    msg += `-------------------------\nüí∞ ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${tot} ‡∏ö‡∏≤‡∏ó\nüì± ‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô: ${trans} ‡∏ö‡∏≤‡∏ó\nü§µ ‡∏ä‡πà‡∏≤‡∏á: ${Math.floor(bE)} ‡∏ö‡∏≤‡∏ó\nüè† ‡∏£‡πâ‡∏≤‡∏ô: ${Math.floor(tot - bE)} ‡∏ö‡∏≤‡∏ó\n-------------------------\n`;
     if (settle === 0) msg += `‚úÖ ‡∏¢‡∏≠‡∏î‡∏û‡∏≠‡∏î‡∏µ`;else msg += `‚ö†Ô∏è ${settle > 0 ? '‡∏ä‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏£‡πâ‡∏≤‡∏ô ' : '‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ä‡πà‡∏≤‡∏á '}${Math.abs(settle)} ‡∏ö‡∏≤‡∏ó`;
 window.open(`https://line.me/R/msg/text/?${encodeURIComponent(msg)}`);
}
    function openSettings(){ $("modalSet").style.display="flex"; $("setShop").value=conf.shop; $("setPerc").value=conf.perc; $("setGuar").value=conf.guar; $("setTheme").value=conf.theme; $("setSound").value=conf.sound; $("setVoice").value=conf.voice; }
    function closeSettings(){ $("modalSet").style.display="none"; }
    function setBg(c){ conf.bg=c; applySettings(); }
    function changeTheme(v){ conf.theme=v; applySettings(); }
    function saveSettings(){ conf.shop=$("setShop").value; conf.perc=Number($("setPerc").value); conf.guar=Number($("setGuar").value); conf.theme=$("setTheme").value; conf.sound=$("setSound").value; conf.voice=$("setVoice").value; localStorage.setItem("barber_conf",JSON.stringify(conf)); applySettings(); closeSettings(); speak("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß"); }
    function applySettings(){ $("shopNameDisp").innerText=conf.shop; $("mainBody").className="theme-"+conf.theme; $("mainBody").style.backgroundColor=conf.bg; }
    function clearAllData(){ if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")){ localStorage.clear(); location.reload(); } }
</script></body></html>


